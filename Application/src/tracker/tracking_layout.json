{ 
"defaults": {
"vars":{
    "start":"{analysis_range.start}",
    "end":"{-:{analysis_range.end}:1}",
    "length":"{-:{global.video_length}:1}",
    "width":"{-:{window_size.x}:20}",
    "width23":"{-:{window_size.x}:22}",

    "circles":"[‚óã,‚óî,‚óë,‚óï,‚óè]",
    "animation":"<sym>{at:{mod:{time}:{array_length:{circles}}}:{circles}}</sym>",

    "back_and_forth":"{abs:{-:{mod:{int:{*:{time}:100}}:510}:255}}",
    "recording_symbol":"<small><sym>‚óè</sym></small> ",
    "recording_alpha":"{min:1.0:{+:0.1:{/:{back_and_forth}:255}}}",

    "highlighted_frame":"{int:{max:0:{min:{length}:{*:{/:{-:{mouse.x}:10}:{-:{window_size.x}:22}}:{-:{global.video_length}:0.5}}}}}",
    "locked_on":"{&&:{<:{{*:{/:{abs:{-:{highlighted_frame}:{global.gui_frame}}}:{length}}:{width23}}}:10}:{not:{key.lalt}}}",
    "smart_highlighted":"{if:{locked_on}:{global.gui_frame}:{highlighted_frame}}",

    "timeline_start":"[{+:10:{*:{/:{analysis_range.start}:{length}}:{width}}},-10]",
    "current_pos":"[{+:11:{*:{/:{global.gui_frame}:{length}}:{width23}}},-9]",

    "displayed_frame_valid": "{equal:{global.gui_frame}:{global.gui_displayed_frame}}",
    "number_individuals":"{if:{is_tracked:{smart_highlighted}}:{.active_individuals:{smart_highlighted}}:''}"
}
},
"objects": [
{
"type":"condition",
"var":"{global.gui_show_timeline}",
"then":{
    "type":"collection",
    "children":[
        {
            "type":"condition",
            "var":"{bool:{global.gui_focus_group}}",
            "then":{
                "type":"collection",
                "pos":[10,90],
                "size":"auto",
                "fill":[50,50,50,125],
                "pad":[10,10,10,10],
                "children": [
                    { 
                        "type":"stext",
                        "max_size":[200,300],
                        "font":{"size":0.6},
                        "pad":[0,0,10,10],
                        "text":"<b>{global.individual_prefix} {at:0:{global.gui_focus_group}}</b>",
                        "pos":[10,10]
                    }
                ]
            }
        },

        {
            "type":"hlayout",
            "pad":[5,0,0,0],
            "pos":"[{-:{window_size.x}:10},6]",
            "origin":[1,0],
            "children":[
                
                {
                    "type":"hlayout",
                    "pad":[-1,0,-1,0],
                    "line":[255,255,255,255],
                    "fill":[1,0,0,0],
                    "children":[
                        {
                            "type":"button",
                            "text":"<sym>‚≠ç</sym> tracked",
                            "font":{"size":0.6},
                            "fill":"{if:{equal:{global.gui_mode}:tracking}:[10,10,10,220]:[40,40,40,220]}",
                            "color":"{if:{equal:{global.gui_mode}:tracking}:[100,100,100,220]:[250,250,250,220]}",
                            "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                            "size":[90,30],
                            "action":"set:gui_mode:tracking"
                        },
                        
                        {
                            "type":"button",
                            "text":"<sym>üéû</sym> raw",
                            "font":{"size":0.6},
                            "fill":"{if:{equal:{global.gui_mode}:blobs}:[10,10,10,220]:[40,40,40,220]}",
                            "color":"{if:{equal:{global.gui_mode}:blobs}:[100,100,100,220]:[250,250,250,220]}",
                            "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                            "size":[60,30],
                            "action":"set:gui_mode:blobs"
                        }
                    ]
                },

                {
                    "type":"button",
                    "text":"<sym>üóò</sym>",
                    "font":{"size":0.6},
                    "size":[30,30],
                    "action":"reanalyse:{global.gui_frame}",
                    "fill":[40,40,40,220],
                    "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                    "color":[250,250,250,200]
                },

                {
                    "type":"list",
                    "size":[90,30],
                    "clickable":true,
                    "list":{
                        "size":"[200,{-:{window_size.y}:50}]",
                        "fill":[25,25,25,220],
                        "line":[120,120,120,220]
                    },
                    "label":{
                        "fill":[40,40,40,220],
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                        "font":{"size":0.6}
                    },
                    "item_color":[60,60,60,100],
                    "detail_color":[150,150,150,255],
                    "foldable":true,
                    "folded":true,
                    "text":" <sym>üñµ</sym> Display",
                    "item_padding":[5,1],
                    "item_font":{"size":0.6},
                    "items":[
                        {
                            "text":"selections",
                            "detail":"{if:{global.gui_show_selections}:'hide':'show'}",
                            "action":"set:gui_show_selections:{not:{global.gui_show_selections}}"
                        },
                        {
                            "text":"video background",
                            "detail":"{if:{global.gui_show_video_background}:'hide':'show'}",
                            "action":"set:gui_show_video_background:{not:{global.gui_show_video_background}}"
                        },
                        {
                            "text":"blobs",
                            "detail":"{if:{global.gui_show_blobs}:'hide':'show'}",
                            "action":"set:gui_show_blobs:{not:{global.gui_show_blobs}}"
                        },
                        {
                            "text":"heatmap",
                            "detail":"{if:{global.gui_show_heatmap}:'hide':'show'}",
                            "action":"set:gui_show_heatmap:{not:{global.gui_show_heatmap}}"
                        },
                        {
                            "text":"gui_show_posture",
                            "detail":"{if:{global.gui_show_posture}:'hide':'show'}",
                            "action":"set:gui_show_posture:{not:{global.gui_show_posture}}"
                        },
                        {
                            "text":"gui_show_midline",
                            "detail":"{if:{global.gui_show_midline}:'hide':'show'}",
                            "action":"set:gui_show_midline:{not:{global.gui_show_midline}}"
                        },
                        {
                            "text":"gui_show_outline",
                            "detail":"{if:{global.gui_show_outline}:'hide':'show'}",
                            "action":"set:gui_show_outline:{not:{global.gui_show_outline}}"
                        },
                        {
                            "text":"gui_show_visualfield",
                            "detail":"{if:{global.gui_show_visualfield}:'hide':'show'}",
                            "action":"set:gui_show_visualfield:{not:{global.gui_show_visualfield}}"
                        },
                        {
                            "text":"gui_show_probabilities",
                            "detail":"{if:{global.gui_show_probabilities}:'hide':'show'}",
                            "action":"set:gui_show_probabilities:{not:{global.gui_show_probabilities}}"
                        },
                        {
                            "text":"gui_show_texts",
                            "detail":"{if:{global.gui_show_texts}:'hide':'show'}",
                            "action":"set:gui_show_texts:{not:{global.gui_show_texts}}"
                        },
                        {
                            "text":"gui_show_graph",
                            "detail":"{if:{global.gui_show_graph}:'hide':'show'}",
                            "action":"set:gui_show_graph:{not:{global.gui_show_graph}}"
                        },
                        {
                            "text":"gui_auto_scale",
                            "detail":"{if:{global.gui_auto_scale}:'hide':'show'}",
                            "action":"set:gui_auto_scale:{not:{global.gui_auto_scale}}"
                        },
                        {
                            "text":"gui_auto_scale_focus_one",
                            "detail":"{if:{global.gui_auto_scale_focus_one}:'hide':'show'}",
                            "action":"set:gui_auto_scale_focus_one:{not:{global.gui_auto_scale_focus_one}}"
                        }
                    ]

                },
                { 
                    "type":"list",
                    "size":[70,30],
                    "list":{
                        "size":"[200,{-:{window_size.y}:50}]",
                        "fill":[25,25,25,220],
                        "line":[120,120,120,220]
                    },
                    "label":{
                        "fill":[40,40,40,220],
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                        "font":{"size":0.6}
                    },
                    "detail_color":[150,150,150,255],
                    "foldable":true,
                    "folded":true,
                    "text":"<sym>‚ò∞</sym> Menu",
                    "item_padding":[5,5],
                    "item_font":{"size":0.6},
                    "item_color":[60,60,60,100],
                    "items":[
                        {
                            "text":"<sym>üì§</sym> Load state",
                            "detail":"loads existing .results file",
                            "action":"load_results"
                        },
                        {
                            "text":"<sym>üì•</sym> Save state",
                            "detail":"save current state to a .results file",
                            "action":"save_results"
                        },
                        {
                            "text":"<sym>üñ´</sym> Export data",
                            "detail":"exports tracking data",
                            "action":"export_data"
                        },
                        {
                            "text":"<sym>üõ†</sym> Save config",
                            "detail":"writes parameters to a .settings file",
                            "action":"write_config"
                        },
                        {
                            "text":"<sym>üëΩüé≠</sym> Apply identities",
                            "detail":"applies VI or TAG information",
                            "action":"auto_correct"
                        },
                        {
                            "text":"<sym>üé≠</sym> Visual identification",
                            "detail":"learn the differences between individuals",
                            "action":"visual_identification"
                        },
                        {
                            "text":"<sym>üëΩ</sym> Categorize",
                            "detail":"applies VI or TAG information",
                            "action":"categorize"
                        },
                        {
                            "text":"<sym>ü¢§</sym> Close file",
                            "detail":"go back to the starting screen",
                            "action":"change_scene:'starting-scene'",
                            "disabled":false
                        },
                        {
                            "text":"<sym>‚èª</sym> Quit",
                            "detail":"exits the application",
                            "action":"quit"
                        }
                    ]
                }
            ]
        },

        {
            "type":"condition",
            "var":"{hovered:info_symbol}",
            "then":{
                "type":"hlayout",
                "pos":"{mulVector:{window_size}:0.5}",
                "origin":[0.5,0.5],
                "fill": [25,25,25,200],
                "pad":[10,10,10,10],
                "children":[
                    {
                        "font":{"size":0.6},
                        "type":"stext",
                        "max_size":"[{min:650:{-:{window_size.x}:100}},{-:{window_size.y}:100}]",
                        "text":"<b>{basename:{global.source}}</b>\n{#global.video_info}"
                    }
                ]
            },
            "else":{ "type":"rect", "size":[0,0]}
        },
        
        {
            "type":"vlayout",
            "pad":[0,10,0,0],
            "children":[
                
                {
                    "type":"hlayout",
                    "pad":[10,-7,0,5],
                    "children":[
                        
                        {
                            "type":"condition",
                            "var":"{equal:{global.video_length}:{tracker.end}}",
                            "then": {
                                "type":"rect",
                                "size":[0,0]
                            },
                            "else": {
                                "type":"button",
                                "action":"set:analysis_paused:{not:{global.analysis_paused}}",
                                "text":"{if:{global.analysis_paused}:'<sym>‚ñ∂</sym>':'<sym>‚è∏</sym>'}",
                                "size":[15,20],
                                "pad":[0,-4.5,0,0],
                                "shadow":0.5,
                                "font":{"size":0.8},
                                "fill":[10,0,0,0],
                                "line":[100,100,100,0],
                                "color":"{if:{global.analysis_paused}:[30,80,30,100]:[200,120,80,100]}"
                            }
                        },

                        {
                            "type":"stext",
                            "clickable":true,
                            "name":"info_symbol",
                            "text":"<sym>üõà</sym>",
                            "shadow":0.5,
                            "color":"{if:{hovered}:[250,250,250,250]:[200,200,200,100]}",
                            "pad":[-5,0,0,7.5]
                        },
                        
                        {
                            "type": "stext",
                            "text": "{.if:{global.gui_run}:'<i>{global.gui_playback_speed}x</i>'}<b>{shorten:{basename:{global.filename}}:50}</b> ‚Äî <c><{if:{displayed_frame_valid}:'a':'orange'}>{global.gui_frame}</{if:{displayed_frame_valid}:'a':'orange'}>/<a>{length}</a></c> {if:{equal:{global.video_length}:{tracker.end}}:'':‚Äî {if:{global.analysis_paused}:'<orange>paused</orange>':'<i>tracking @</i>'} <i><a>{int:{fps}}</a>fps</i>}",
                            "font":{ "size":0.65 },
                            "shadow":0.5,
                            "pad":[-5,0,0,7.5]
                        }
                    ]
                },

                
                {
                    "type":"collection",
                    "name":"timeline",
                    "clickable":true,
                    "children":[
                        {
                            "type": "rect",
                            "pos": [10, -10],
                            "size": "[{width},30]",
                            "fill": [30,30,30,0],
                            "line": [255,255,255,220],
                            "clickable":true,
                            "drag": "set:gui_frame:{min:{length}:{*:{/:{-:{mouse.x}:10}:{-:{window_size.x}:22}}:{-:{global.video_length}:0.5}}}"
                        },
                        {
                            "type": "rect",
                            "pos": [0,-10],
                            "size": [11,30],
                            "fill": [30,30,30,0],
                            "line": [255,255,255,0],
                            "clickable":true,
                            "drag": "set:gui_frame:0"
                        },
                        {
                            "type": "rect",
                            "pos": "[{+:{width}:9},-10]",
                            "size": [11,30],
                            "fill": [30,30,30,0],
                            "line": [255,255,255,0],
                            "clickable":true,
                            "drag": "set:gui_frame:{length}"
                        },
                        {
                            "type": "rect",
                            "pos": "[{+:11:{*:{/:{max:{global.gui_frame}:{tracker.end}}:{length}}:{-:{window_size.x}:22}}},-9]",
                            "size": "[{max:0:{-:{-:{window_size.x}:11}:{+:11:{*:{/:{max:{global.gui_frame}:{tracker.end}}:{length}}:{width23}}}}},28]",
                            "fill": [0,0,0,0],
                            "line": [250,250,250,0],
                            "clickable":false
                        },

                        {
                            "type": "rect",
                            "pos": "{current_pos}",
                            "size": "[{+:10:{-:{*:{/:{max:{global.gui_frame}:{min:{min:{global.video_length}:{-:{tracker.end}:1}}:{end}}}:{length}}:{-:{window_size.x}:22}}:{at:0:{current_pos}}}},28]",
                            "fill": [20,40,50,180],
                            "line": [250,250,250,0],
                            "clickable":false
                        },
                        
                        {
                            "type": "rect",
                            "pos": "{timeline_start}",
                            "size": "[{*:{/:{-:{global.gui_frame}:{start}}:{length}}:{width}},30]",
                            "fill": [20,20,20,180],
                            "line": [255,255,255,220],
                            "clickable":false
                        },

                        {
                            "type": "rect",
                            "pos": "{timeline_start}",
                            "size": "[{+:{-:{*:{/:{end}:{length}}:{width}}:{at:0:{timeline_start}}}:10},30]",
                            "fill": [50,150,50,0],
                            "line": [150,150,150,0],
                            "clickable":false
                        }
                    ]
                }
            ]
        },

        {
            "type":"hlayout",
            "pos":"{addVector:[0,{-:{window_size.y}:5}]:0}",
            "origin":[0,1],
            "pad":[10,10,0,0],
            "children":[
                
                {
                    "type":"settings",
                    "var":"",
                    "font":{"size":0.6,"align":"center"},
                    "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                    "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                    "list":{
                        "line":[220,220,220,200],
                        "fill":[25,25,25,220],
                        "size":[600,300]
                    },
                    "size":[600,40],
                    "color":[225,225,225],
                    "desc":"",
                    "highlight_clr":[75,75,75,255]
                }
            ]
        },

        {
            "type":"hlayout",
            "pos":"{addVector:[{-:{window_size.x}:10},{-:{window_size.y}:10}]:0}",
            "origin":[1,1],
            "pad":[0,10,0,0],
            "children":[
                {
                    "type":"condition",
                    "var":"{global.gui_is_recording}",
                    "then":
                    {
                        "type":"stext",
                        "color":[150,50,50,255],
                        "alpha":"{recording_alpha}",
                        "text":" {recording_symbol}",
                        "shadow":0.5,
                        "font":{"size":0.6}
                    }
                },
                {
                    "type":"stext",
                    "font":{"size":0.52},
                    "text":"{if:{vi_busy}:'<i>Applying VI</i> {int:{*:{vi_apply_percent}:100}}<i>% ...</i> ':''}<i>{round:{mouse_in_bowl.x}},{round:{mouse_in_bowl.y}}</i> <h5><sym>üñ∞</sym></h5>{if:{status_text}:{status_text}:''}",
                    "color":"{if:{&&:{>=:{mouse_in_bowl.x}:0}:{<:{mouse_in_bowl.x}:{video_size.x}}:{>=:{mouse_in_bowl.y}:0}:{<:{mouse_in_bowl.y}:{video_size.y}}}:[255,255,255,255]:[200,120,80,100]}"
                }
            ]
        },

        {
            "type":"condition",
            "var":"{||:{hovered:timeline}:{hovered}}",
            "z-index":1,
            "then":
            {
                "type":"vlayout",
                "pos":"[{min:{-:{window_size.x}:55}:{max:58:{mouse.x}}},69]",
                "origin":[0.5,0],
                "clickable":true,
                "align":"center",
                "fill": [25,25,25,100],
                "line":[75,75,75],
                "children":[
                    
                    {
                        "type":"button",
                        "text":"<sym>üóò</sym> from {if:{locked_on}:<nr>{smart_highlighted}</nr>:{highlighted_frame}}",
                        "action":"reanalyse:{smart_highlighted}",
                        "fill":[40,40,40,220],
                        "line":[100,100,100,100],
                        "color":[225,225,225],
                        "font":{"size":0.6,"align":"center"},
                        "size":[120,25]
                    },
                    {
                        "type":"stext",
                        "pad":[5,5,5,5],
                        "text":"{if:{is_segment:{smart_highlighted}}:'<b>{.get_segment:{smart_highlighted}}</b>':'<i>no segment</i>'}\n{if:{number_individuals}:'{number_individuals} {global.individual_prefix}':''}",
                        "font":{"size":0.6}
                    }
                ]
            }
        }
    ]
}
}


]}