{ "defaults": {
    "font": {
        "size": 0.75,
        "align": "left"
    },
    "color":[225,225,225,255],
    "highlight_clr":[50,50,75],
    "window_color":[10,10,10],
    "vars":{
        "element_w":"{-:{window_size.x}:160}"
    }
  },
  "objects":[{
    "type":"vlayout",
    "align":"left",
    "pad":[30,10,10,10],
    "children":[
        { "type":"stext",
          "pad":[0,10,0,0],
          "text":"<h2>Segmentation Settings</h2>Please choose how you want to process the video you provided.", 
          "font":{ "size":0.8 }
        },
        {
            "type":"gridlayout",
            "vertical_clr":[0,0,0,50],
            "pad":[5,5,5,5],
            "clickable":true,
            "halign":"left",
            "valign":"top",
            "children":[
                [
                    {
                        "type":"text",
                        "text":"source",
                        "pos":[0,6]
                    },
                    {
                        "type":"settings",
                        "var":"source",
                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                        "list":{
                            "line":[220,220,220,200],
                            "fill":[25,25,25,220],
                            "size":"[{element_w},200]"
                        },
                        "size":"[{element_w},40]",
                        "desc":"",
                        "preview":{
                            "font":{"size":0.5},
                            "color":[125,125,125,125],
                            "max_size":"[{element_w},80]"
                        }
                    }
                ],

                [
                    {
                        "type":"text",
                        "text":"target",
                        "pos":[0,6]
                    },
                    {
                        "type":"settings",
                        "var":"output_dir",
                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                        "list":{
                            "line":[220,220,220,200],
                            "fill":[25,25,25,220],
                            "size":"[{element_w},200]"
                        },
                        "size":"[{element_w},40]",
                        "desc":""
                    }
                ],

                [
                    {
                        "type":"text",
                        "text":"target",
                        "pos":[0,6]
                    },
                    {
                        "type":"settings",
                        "var":"filename",
                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                        "list":{
                            "line":[220,220,220,200],
                            "fill":[25,25,25,220],
                            "size":"[{element_w},200]"
                        },
                        "size":"[{element_w},40]",
                        "desc":""
                    }
                ],

                [
                    [],
                    {
                        "type":"settings",
                        "var":"track_background_subtraction",
                        "invert":true,
                        "label":{
                            "line":"{if:{||:{selected}:{hovered}}:[100,175,250,240]:[100,100,100,250]}",
                            "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,240]:[50,50,50,240]}"
                        },
                        "size":"[{min:150:{max:100:{-:{element_w}:295}}},45]",
                        "pad":[0,0,10,0],
                        "desc":"Use machine learning to detect animals"
                    }
                ],

                [
                    {
                        "type":"text",
                        "text":"{if:{global.track_background_subtraction}:'averaging':'model'}",
                        "pos":[0,6]
                    },
                    {
                        "type":"settings",
                        "var":"{if:{global.track_background_subtraction}:'averaging_method':'model'}",
                        "label":{
                            "line":"{if:{||:{selected}:{hovered}}:[100,175,250,240]:[100,100,100,250]}",
                            "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,240]:[50,50,50,240]}"
                        },
                        "list":{
                            "line":[220,220,220,200],
                            "fill":[25,25,25,220],
                            "size":"[{element_w},200]"
                        },
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,240]:[100,100,100,50]}",
                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,40]:[50,50,50,240]}",
                        "size":"{if:{global.track_background_subtraction}:[250,40]:[{element_w},40]}",
                        "desc":""
                    }
                ],

                [
                    {
                        "type":"text",
                        "text":"{if:{global.track_background_subtraction}:'threshold':'region'}",
                        "pos":[0,6]
                    },
                    {
                        "type":"settings",
                        "var":"{if:{global.track_background_subtraction}:'threshold':'region_model'}",
                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                        "list":{
                            "line":[220,220,220,200],
                            "fill":[25,25,25,220],
                            "size":"[{element_w},200]"
                        },
                        "size":"[{element_w},40]",
                        "desc":""
                    }
                ],

                [
                    {
                        "type":"text",
                        "text":"{if:{global.track_background_subtraction}:'invert':'GPU'}",
                        "pos":[0,10]
                    },
                    {
                        "type":"hlayout",
                        "pad":[0,0,10,0],
                        "children":[
                        { "type":"hlayout",
                            "pad":[0,0,10,0],
                            "children":[
                                {
                                    "type":"settings",
                                    "var":"{if:{global.track_background_subtraction}:'image_invert':'gpu_torch_device'}",
                                    "label":{
                                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,240]:[100,100,100,250]}",
                                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,240]:[50,50,50,240]}"
                                    },
                                    "size":"[{min:200:{max:120:{element_w}}},45]",
                                    "desc":""
                                },
                                {
                                    "type":"condition",
                                    "var":"{&&:{not:{global.track_background_subtraction}}:{not:{equal:{global.gpu_torch_device}:automatic}}}",
                                    "then":{
                                        "type":"settings",
                                        "var":"{if:{global.track_background_subtraction}:'image_invert':'gpu_torch_index'}",
                                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                                        "size":"[{min:200:{max:120:{element_w}}},45]",
                                        "desc":""
                                    },
                                    "else":{
                                        "type":"rect",
                                        "size":[0,0]
                                    }
                                }
                            ]
                        }]
                    }
                ],

                [
                    {
                        "type":"text",
                        "text":"#animals",
                        "pos":[0,6]
                    },
                    {
                        "type":"settings",
                        "var":"track_max_individuals",
                        "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                        "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                        "size":"[{element_w},40]",
                        "desc":""
                    }
                ],

                [
                    {
                        "type":"stext",
                        "text":"<b>kinematics</b>",
                        "pos":[0,11]
                    },
                    {
                        "type":"hlayout",
                        "pad":[0,0,10,0],
                        "children":[
                        { "type":"hlayout",
                            "pad":[0,0,10,0],
                            "children":[

                            {
                                "type":"stext",
                                "text":"max speed (cm/s)",
                                "pos":[0,0]
                            },
                            {
                                "type":"settings",
                                "var":"track_max_speed",
                                "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                                "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                                "size":"[{*:{max:50:{-:{element_w}:451}}:0.5},45]",
                                "desc":""
                            },
                            {
                                "type":"stext",
                                "text":"conversion\n(cm/pixel)",
                                "pos":[0,0]
                            },
                            {
                                "type":"settings",
                                "var":"cm_per_pixel",
                                "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                                "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                                "size":"[{*:{max:50:{-:{element_w}:451}}:0.5},45]",
                                "desc":""
                            },
                            {
                                "type":"button",
                                "text":"Calibrate",
                                "fill":[50,90,50],
                                "size":[150,45],
                                "action":"calibrate"
                            }
                            ]
                        }]
                    }
                ]
            ]
        },
        
        {
            "type":"stext",
            "max_size":"[{element_w},{-:{window_size.y}:650}]",
            "fade_out":1.0,
            "color":[250,250,250],
            "pad":[3,3,3,3],
            "text":"<h2>Advanced Settings</h2>detect_iou_threshold={#global.detect_iou_threshold} detect_conf_threshold={#global.detect_conf_threshold} track_threshold={#global.track_threshold} averaging_method={#global.averaging_method} track_posture_threshold={#global.track_posture_threshold} track_background_subtraction={#global.track_background_subtraction} model=<str>{global.detect_model}</str> region_model=<str>{global.region_model}</str>",
            "font":{ "size":0.65 }
        }
    ]},

    {
        "type":"hlayout",
        "align":"center",
        "pad":[5,0,5,0],
        "pos":"[10,{-:{window_size.y}:10}]",
        "origin":[0,1],
        "children":[
            {
                "type":"settings",
                "var":"",
                "font":{"size":0.6,"align":"center"},
                "fill":"{if:{||:{selected}:{hovered}}:[60,60,60,200]:[50,50,50,200]}",
                "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,50]}",
                "placeholder":"<sym>🔍</sym> Parameters",
                "postfix":"test",
                "list":{
                    "line":[220,220,220,200],
                    "fill":[25,25,25,220],
                    "size":"[{max:350:{-:{element_w}:90}},300]"
                },
                "size":"[{max:350:{-:{element_w}:90}},40]",
                "color":[225,225,225],
                "desc":"",
                "highlight_clr":[75,75,75,255]
            }
        ]
    },

    {
        "type":"hlayout",
        "align":"center",
        "pad":[5,0,5,0],
        "pos":"[{-:{window_size.x}:10},{-:{window_size.y}:10}]",
        "origin":[1,1],
        "children":[
            {
                "type":"button",
                "text":"<sym>🛇</sym> Cancel",
                "fill":[40,40,40,220],
                "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,150]}",
                "size":[100,40],
                "font":{
                    "align":"center",
                    "size":0.65
                },
                "action": "change_scene:'starting-scene'"
            },
            {
                "type":"button",
                "text":"Next <sym>⮞</sym>",
                "fill":[40,40,40,220],
                "line":"{if:{||:{selected}:{hovered}}:[100,175,250,200]:[100,100,100,150]}",
                "size":[100,40],
                "font":{
                    "align":"center",
                    "size":0.65
                },
                "action": "convert"
            }
        ]
    }
]}
